---
title: Self-host Contember
description: Advanced guide to run Contember on your own infrastructure.
---

:::caution
This is an advanced guide. You don't need this - skip the hassle and [deploy to Contember Cloud](./deploy-contember.md). To complete this guide you are expected to know how to run Docker containers in production.
:::

## What you'll need

1. PostgreSQL database ([AWS RDS for PostgreSQL](https://aws.amazon.com/rds/postgresql/), [DigitalOcean Managed Database](https://www.digitalocean.com/products/managed-databases/))
1. S3-compatible storage for file uploads ([AWS S3](https://aws.amazon.com/s3/), [DigitalOcean Spaces](https://www.digitalocean.com/products/spaces/), [MinIO](https://min.io/), [CEPH](https://ceph.io/), [Zenko CloudServer](https://www.zenko.io/cloudserver/))
1. SMTP server to send emails from
1. Some way to run Docker image. You'll need a provider that supports: `Docker`, `Docker Compose`, `SSH access` and Proxy server.

## Deploy Contember Engine

### 1. Setup PostgresSQL database

Required PostgresSQL version is 10 or newer.

Contember needs following databases: 
- tenant (for information about users and their roles) and
- content database for each deployed project.

Contember itself manages these databases and runs migrations upon startup. You don't need to create content database if the PostgresSQL user given to Contember has permission to create it on it's own.


### 2. Setup S3 bucket

This bucket will be used to store user uploads. You will need a key and it's secret with permissions to create objects.


### 3. Setup SMTP server

Get SMTP credentials for your mailing server - used for example for password reset.


### 4. Run Contember Engine Docker container

Contember Engine is deployed as a Docker container. It's [published on Docker Hub](https://hub.docker.com/r/contember/engine/tags) as `contember/engine`. 

Configure following environment variables:

```yaml
NODE_ENV: "production"
CONTEMBER_PORT: "4000" # Port on which the service will be available
CONTEMBER_LOGIN_TOKEN: "..." # Login token used (20 random [0-9a-f] characters; can be generated by `openssl rand -hex 20` command)
CONTEMBER_ROOT_TOKEN: "..." # Root token used (20 random [0-9a-f] characters; can be generated by `openssl rand -hex 20` command)
CONTEMBER_ROOT_EMAIL: "admin@example.com" # Superadmin user's e-mail
CONTEMBER_ROOT_PASSWORD: "my-secret-password" # Superadmin user's password

# Credentials for database:
DEFAULT_DB_HOST: "your-db-server.com"
DEFAULT_DB_PORT: "5432"
DEFAULT_DB_USER: "postgres"
DEFAULT_DB_PASSWORD: "postgres"
DEFAULT_DB_SSL: "true"
TENANT_DB_NAME: "tenant" # Name of tenant database - see first step

# S3 credentials - see step 2
DEFAULT_S3_REGION: "rgn1"
DEFAULT_S3_KEY: "..."
DEFAULT_S3_SECRET: "..."
DEFAULT_S3_ENDPOINT: "https://rgn1.yours3provider.com"
DEFAULT_S3_BUCKET: "your-bucket"

# SMTP credentials - see step 3
TENANT_MAILER_HOST: "send.your-smtp.com"
TENANT_MAILER_PORT: "2525"
TENANT_MAILER_FROM: "noreply@example.com"
```

HTTP server should start on specified port. You can add load-balancer in front of the app. The container is stateless and therefor completely scalable.

## Deploy Contember Admin

_ðŸ§± TODO_